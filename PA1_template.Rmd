---
title: "Reproducible Research: Peer Assessment 1"
output: 
html_document:
keep_md: true
---

```{r}

Sys.setlocale("LC_TIME", "English")

```


## Loading and preprocessing the data
```{r}

unzip('activity.zip')
rawData <- read.csv('activity.csv')

```


## What is mean total number of steps taken per day?
```{r}
grouped = aggregate (steps ~ date, data = rawData, FUN=sum)
barplot(
    height    = grouped$steps, 
    names.arg = grouped$date,
    col       = rainbow(400), 
    las       = 2
    )

grouped.mean <- mean(grouped$steps)


grouped.median <- median(grouped$steps)


```
mean is `r as.integer(grouped.mean)` and median is `r as.integer(grouped.median)`

## What is the average daily activity pattern?
```{r}
interval <- aggregate(steps ~ interval, data = rawData, FUN = mean)
plot(interval, type = "l")

maxRow <- which.max(interval$steps)
maxInt <- interval$interval[maxRow]

```
Interval contains the maximum number of steps is #`r maxInt`


## Imputing missing values

```{r}

naElements <- rawData[!complete.cases(rawData),]
naElements <- nrow(naElements)


```

Total missing values - `r naElements`

```{r}

imputedData <- rawData; #copy of raw data


getMeanByInterval <- function(int){
    
    round(interval[interval[,1] ==int, 2])
        
}

i<-1;
for (element in 1:nrow(imputedData))
{ 
    if (is.na(imputedData[element,1]))
    { 
        imputedData[element,]$steps <- getMeanByInterval(imputedData[element,]$interval)
        

      # imputedData[element, 1] = c[]
    }
}


imputedByDate <- aggregate(steps ~ date, data = imputedData, FUN = sum)
barplot(imputedByDate$steps, names.arg = imputedByDate$date, xlab = "date", ylab = "steps")

mean(imputedByDate$steps)
median(imputedByDate$steps)

```
## Are there differences in activity patterns between weekdays and weekends?
```{r}
getDayType <- function(d)
{
    
    strDay <- weekdays(as.Date(d));
   # print(strDay)
    
    if (strDay %in% c("Saturday","Sunday"))
    {
        return("weekend")
    }
    else
    {
        return ("weekday")
    }
}

imputedData$dayType <- sapply(imputedData$date, getDayType)


plotByDayType <- function(type)
    {
    
     dayTypePlot <- aggregate(
        steps ~ interval, 
        data = imputedData, 
        subset = imputedData$dayType == type, 
        FUN = mean)
     plot(dayTypePlot, type = "l", main = type)
    }


par(mfrow = c(1, 2))

plotByDayType("weekend");
plotByDayType("weekday");
 




 
```

